
## Сломай калькулятор

В руки попал самый обычный на вид калькулятор, запущенный на веб-сервере. Однако, ходят слухи, что в нём есть скрытая уязвимость. Твоя задача — разобраться, как воспользоваться этим уязвимым калькулятором и найти флаг.

  

## Решение
Мы заходим на сайт с калькулятором и исследуем его поведение. При выполнении операций калькулятор отправляет запрос на сервер в формате JSON, например:

```json
{ "expression": "1234+1234" }
```
На сервере, скорее всего, используется опасная функция `eval()` для выполнения выражений, что открывает возможность для выполнения произвольного кода. Это означает, что вместо арифметических выражений можно подставить команды на Python и выполнить их на сервере.

#### Шаги атаки

1.  **Отправка произвольного кода**:  
    Мы можем попытаться выполнить системную команду для просмотра содержимого файловой системы. Для этого изменим запрос:
    
 ```json
    { "expression": "os.popen('ls /').read()" } 
```
    
  Сервер выполнит команду `ls /`, и в ответе мы увидим список файлов в корневой директории, включая `flag.txt`.
    
2.  **Чтение содержимого файла**:  
    Теперь, когда мы знаем, что файл `flag.txt` существует, можно попытаться его прочитать. Для этого отправим следующий запрос:
    
``` json
    { "expression": "os.popen('cat /flag.txt').read()" }
   ```
   Так сервер вернёт содержимое файла с флагом.